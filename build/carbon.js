var Carbon={};Carbon.Revision="0.0.1",function(){"use strict";Carbon.call=function(e,t,o){"function"==typeof o?(o.call(e,t),Carbon.Element.call(e,t)):Carbon.Element.call(e,t)},Carbon.create=function(e,t){"function"==typeof t?(e.prototype=Object.create(t.prototype),e.prototype.registerProperty=Carbon.Element.prototype.registerProperty,e.prototype.registerProperties=Carbon.Element.prototype.registerProperties,e.prototype.bindProperty=Carbon.Element.prototype.bindProperty,e.prototype.addEventListener=Carbon.Element.prototype.addEventListener,e.prototype.removeEventListener=Carbon.Element.prototype.removeEventListener,e.prototype.dispatchEvent=Carbon.Element.prototype.dispatchEvent,e.prototype.debounce=Carbon.Element.prototype.debounce,e.prototype._uuidChanged=Carbon.Element.prototype._uuidChanged,e.prototype.dispose=Carbon.Element.prototype.dispose):e.prototype=Object.create(Carbon.Element.prototype),e.prototype.constructor=e}}();
!function(){"use strict";Carbon.Property=function(e,t,i){this.key=t,this.parent=e,this["default"]=i.value,this.type=i.type,this.observer=void 0,this.notify=!1,this.writable=!0,this.persist=!1,this.enumerable=!0,this._path=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i&&this.define(i)},Carbon.Property.prototype.define=function(e){void 0!==e.value&&(this["default"]=e.value),void 0!==e.type&&(this.type=e.type),void 0!==e.observer&&(this.observer=e.observer),void 0!==e.notify&&(this.notify=e.notify),void 0!==e.writable&&(this.writable=e.writable),void 0!==e.persist&&(this.persist=e.persist),void 0!==e.enumerable&&(this.enumerable=e.enumerable)},Carbon.Property.prototype.setValue=function(e){if(this.writable===!1&&void 0!==this.value)return void console.warn("Carbon.Element: "+this.key+" is read only.");if(this.type&&void 0!==e)if(this.type===String){if("string"!=typeof e)return void console.warn("Carbon.Element: "+this.key+" is incorrect type.")}else if(this.type===Boolean){if("boolean"!=typeof e)return void console.warn("Carbon.Element: "+this.key+" is incorrect type.")}else if(this.type===Number){if("number"!=typeof e)return void console.warn("Carbon.Element: "+this.key+" is incorrect type.")}else if("function"==typeof this.type&&!(e instanceof this.type))return void console.warn("Carbon.Element: "+this.key+" is incorrect type.");this.value=e,this.persist===!0&&this.setPersistedValue()},Carbon.Property.prototype.setPersistedValue=function(){localStorage.setItem(this.parent.uuid+"_"+this.key,JSON.stringify(this.value))},Carbon.Property.prototype.getPersistedValue=function(){var e=localStorage.getItem(this.parent.uuid+"_"+this.key),t=this.type;if(null!==e){if(t===Number||t===String||t===Boolean)e=JSON.parse(e);else if("function"==typeof t){var i=JSON.parse(e);e=new t;for(var r in i)e[r]=i[r]}return e}return this["default"]}}();
!function(){"use strict";Carbon.Element=function(e){Object.defineProperties(this,{_config:{value:e||{}},_properties:{value:{}},_bindings:{value:{}},_debouncers:{value:{}},_listeners:{value:{}},_parents:{value:[]},_children:{value:{}},_ready:{value:!1,writable:!0}}),this.registerProperties({uuid:{type:String,observer:"_uuidChanged"}}),setTimeout(function(){this.ready&&this.ready(),this._ready=!0}.bind(this))},Carbon.Element.prototype.registerProperty=function(e,t,i){void 0===this._properties[e]?this._properties[e]=new Carbon.Property(this,e,t):this._properties[e].define(t);var r=this._properties[e];i instanceof Array&&i[0]instanceof Carbon.Element&&"string"==typeof i[1]?i[0]._ready?r["default"]=i[0][i[1]]:r["default"]=i[0]._config[i[1]]:i&&(r["default"]=i);var s;if(!this.hasOwnProperty(e)){var n={key:e,element:this};Object.defineProperty(this,e,{get:function(){return r.value},set:function(t){r.value!==t&&(s=r.value,r.setValue(t),s instanceof Carbon.Element&&(s._parents.splice(s._parents.indexOf(n),1),delete this._children[e]),t instanceof Carbon.Element&&(t._parents.push(n),this._children[e]=t),void 0!==r.observer&&(this._ready?this[r.observer].call(this,{value:t,oldValue:s}):this.debounce(r._path+"-init",function(){this[r.observer].call(this,{value:t,oldValue:s})}.bind(this))),r.notify===!0&&this.dispatchEvent({type:r._path+"-changed",key:e,value:t,oldValue:s}))},enumerable:r.enumerable})}i instanceof Array&&i[0]instanceof Carbon.Element&&"string"==typeof i[1]&&(i[0]._ready?i[0].bindProperty(i[1],this,e):this.debounce("bind-property"+e,function(){i[0].bindProperty(i[1],this,e)}.bind(this))),r.persist?this[e]=r.getPersistedValue():this[e]=r["default"]},Carbon.Element.prototype.registerProperties=function(e){for(var t in e){var i=e[t],r=this._config[t];this.registerProperty(t,i,r)}},Carbon.Element.prototype.bindProperty=function(e,t,i){t instanceof HTMLElement&&(t._properties=t._properties||{},t._properties[i]=new Carbon.Property(t,i,{}));var r=this,s=this._properties[e]._path;this._properties[e].notify=!0,t._properties[i].notify=!0,this._bindings[s]={source:r,target:t,sourcePath:r._properties[e]._path,targetPath:t._properties[i]._path,sourceObserver:function(){t[i]=r[e]},targetObserver:function(){r[e]=t[i]}},r.addEventListener(this._bindings[s].sourcePath+"-changed",this._bindings[s].sourceObserver),t.addEventListener(this._bindings[s].targetPath+"-changed",this._bindings[s].targetObserver),void 0!==r[e]?t[i]=r[e]:void 0!==t[i]&&(r[e]=t[i])},Carbon.Element.prototype.addEventListener=function(e,t){void 0===this._listeners[e]&&(this._listeners[e]=[],this._listeners[e].regExp=new RegExp("^"+e.replace(/[*]/g,".*").toLowerCase().trim()+"$")),-1===this._listeners[e].indexOf(t)&&this._listeners[e].push(t)},Carbon.Element.prototype.removeEventListener=function(e,t){if(void 0!==this._listeners[e]){var i=this._listeners[e].indexOf(t);if(-1!==i)return void this._listeners[e].splice(i,1)}console.warn("Carbon.Element: Could not find listener",e)},Carbon.Element.prototype.removeEventListeners=function(e){if("string"==typeof e&&void 0!==this._listeners[e]&&(this._listeners[e].length=0),"function"==typeof e)for(var t in this._listeners){var i=this._listeners[t].indexOf(e);-1!==i&&this._listeners[t].splice(i,1)}},Carbon.Element.prototype.dispatchEvent=function(e){var t=e.type,i=[];for(var r in this._listeners)this._listeners[r].regExp.test(t)&&(i=i.concat(this._listeners[r]));if(e.target=e.target||this,void 0!==i)for(var s=0;s<i.length;s++)i[s].call(this,e);if(e.bubble===!0)for(var n=0;n<this._parents.length;n++)e.type=this._parents[n].key+"."+t,this._parents[n].element.dispatchEvent(e)},Carbon.Element.prototype.debounce=function(e,t,i){window.clearTimeout(this._debouncers[e]),this._debouncers[e]=setTimeout(function(){t(),delete this._debouncers[e]}.bind(this),i)},Carbon.Element.prototype._uuidChanged=function(){for(var e in this._properties)this._properties[e].persist&&(this[e]=this._properties[e].getPersistedValue())},Carbon.Element.prototype.dispose=function(){for(var e in this._config)delete this._config[e];for(e in this._properties)delete this._properties[e];for(e in this._bindings)this._bindings[e].source.removeEventListener(this._bindings[e].sourcePath+"-changed",this._bindings[e].sourceObserver),this._bindings[e].target.removeEventListener(this._bindings[e].targetPath+"-changed",this._bindings[e].targetObserver),delete this._bindings[e];for(e in this._debouncers)window.clearTimeout(this._debouncers[e]),delete this._debouncers[e];for(e in this._listeners){for(var t=this._listeners[e].length;t--;)this.removeEventListener(e,this._listeners[e][t]);delete this._listeners[e]}this._parents.length=0;for(e in this._children)delete this._children[e]}}();